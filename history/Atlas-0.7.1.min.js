/**
 * Atlas.js v0.7.1
 * https://github.com/steelydylan/Atlas.js
 * Copyright steelydylan
 * <http://steelydylan.webcrow.jp/>
 * Released under the MIT license.
 */
(function(){var h=[];var j=[];var a=[];var s=0;var m=(function(){var u=navigator.userAgent;if((u.indexOf("iPhone")>0&&u.indexOf("iPad")==-1)||u.indexOf("iPod")>0||u.indexOf("Android")>0){return true}else{return false}})();var c=(function(w){var v=window.matchMedia("(orientation: portrait)");var u="";if(v.matches){return"portrait"}else{return"landscape"}})();var g=function(u,x,y){var z=y.which;switch(z){case 13:u.enter=true;x.enter=true;break;case 16:u.shift=true;x.shift=true;break;case 32:u.space=true;x.space=true;break;case 39:u.right=true;x.right=true;break;case 37:u.left=true;x.left=true;break;case 38:u.up=true;x.up=true;break;case 40:u.down=true;x.down=true;break;case 8:u.backspace=true;x.backspace=true;break}for(var v=0;v<26;v++){if(v+65==z){var w=String.fromCharCode(v+97);u[w]=true;x[w]=true;break}}};var t=function(u){u.enter=false;u.shift=false;u.space=false;u.right=false;u.left=false;u.up=false;u.down=false;u.backspace=false;for(var v=0;v<26;v++){u[String.fromCharCode(v+97)]=false}};var l=(function(){var u=new Object();t(u);return u})();var p=function(){for(var u in p){window[u]=p[u]}};p.createClass=function(v,x){var w=function(){this.initialize.apply(this,arguments)};if(typeof v=="function"&&typeof x=="object"){w.prototype=Object.create(v.prototype);w.prototype.inherit=function(){this.initialize=this.superClass.prototype.initialize;this.superClass=this.superClass.prototype.superClass;if(this.initialize){this.initialize.apply(this,arguments)}}}else{if(typeof v=="object"&&x==null){x=v}}for(var u in x){w.prototype[u]=x[u]}w.prototype.superClass=v;return w};p.extendClass=function(u,w){for(var v in w){u.prototype[v]=w[v]}};var i=function(w,v,z){var u=w.mover;var y=u[u.length-1];if(y&&y.and){var x=y}else{var x=new Object();u.push(x)}x.time=0;if(z){x.frame=z}x.loop=false;x.and=false;x[v]=true;return x};var e=p.createClass({isMobile:m,orientation:c,initialize:function(){this.eventListener=new Object();this.mover=[];this.rot=0;this.moverIndex=0;this.visible=true;this.eventEnable=true;this.drawMode="source-over";var u=this.eventListener;u.touchStart=false;u.touchMove=false;u.touchEnd=false;u.keyUp=false;u.keyDown=false;u.multiTouchStart=false;u.multiTouchMove=false;u.multiTouchEnd=false;u.orientationChange=false},tween:function(){var u=this.mover;var v=u.length;if(this.moverIndex<v){var w=u[this.moverIndex];if(w.animate){this._animate(w)}if(w.moveTo){this._moveTo(w)}if(w.moveBy){this._moveBy(w)}if(w.rotateBy){this._rotateBy(w)}if(w.scaleBy){this._scaleBy(w)}if(w.then){this._then(w)}w.time++;if(w.time>w.frame){this.moverIndex++;if(this.moverIndex==v){if(w.loop){this._refresh()}else{this.stop()}}}}},isQueEmpty:function(){return this.mover.length?false:true},_refresh:function(){this.moverIndex=0;var u=this.mover;for(var v=0,x=u.length;v<x;v++){var w=u[v];if(w.time){w.time=0}}},moveTo:function(u,z,w){var v=i(this,"moveTo",w);v.toX=u;v.toY=z;return this},_moveTo:function(u){if(u.time==0){u.diffX=u.toX-this.x;u.diffY=u.toY-this.y}this.x=u.toX-u.diffX*(1-u.time/u.frame);this.y=u.toY-u.diffY*(1-u.time/u.frame)},moveBy:function(u,z,w){var v=i(this,"moveBy",w);v.diffX=u;v.diffY=z;return this},_moveBy:function(u){if(u.time==0){u.toX=this.x+u.diffX;u.toY=this.y+u.diffY}this.x=u.toX-u.diffX*(1-u.time/u.frame);this.y=u.toY-u.diffY*(1-u.time/u.frame)},delay:function(v){var u=i(this,"delay",v);this.mover.push(u);return this},and:function(){var u=this.mover;var v=u[u.length-1];if(v){v.and=true}return this},stop:function(){this.mover=[];this.moverIndex=0;return this},loop:function(){var u=this.mover[this.mover.length-1];u.loop=true;return this},rotateBy:function(w,v){var u=i(this,"rotateBy",v);u.diffAngle=w;return this},_rotateBy:function(u){if(u.time==0){u.toAngle=this.rot+u.diffAngle}this.rot=u.toAngle-u.diffAngle*(1-u.time/u.frame)},then:function(u,w){var v=i(this,"then",w);v.exec=u;return this},_then:function(u){u.exec.call(this)},scaleBy:function(u,z,w){var v=i(this,"scaleBy",w);v.scaleX=u;v.scaleY=z;return this},setPosition:function(u,v){this.x=u;this.y=v;return this},saveData:function(v){var w=new Object();for(var u in this){if(typeof(this[u])!="function"){w[u]=this[u]}}localStorage.setItem(v,JSON.stringify(w))},getData:function(v){var w=JSON.parse(localStorage.getItem(v));for(var u in w){this[u]=w[u]}},getTouchPosition:function(A,z){if(!(z&&A.touches[z])){z=0}var C=this.field;var u=parseInt(C.width)/parseInt(C.style.width);var G=parseInt(C.height)/parseInt(C.style.height);var w=new Object();var v=C.getBoundingClientRect();var D=parseInt(v.left);var B=parseInt(v.top);if(isNaN(D)){D=0}if(isNaN(B)){B=0}var F=document.documentElement.scrollLeft||document.body.scrollLeft;var E=document.documentElement.scrollTop||document.body.scrollTop;if(A){if(!m||(m&&A.touches[z])){w.x=(m?A.touches[z].pageX:A.pageX)-D-F;w.y=(m?A.touches[z].pageY:A.pageY)-B-E}else{w.x=-1;w.y=-1}}else{w.x=event.x-D;w.y=event.y-B}w.x=parseInt(w.x*u);w.y=parseInt(w.y*G);return w},getMultiTouchPosition:function(w){var v=w.touches.length;var x=[];for(var u=0;u<v;u++){x[u]=this.getTouchPosition(w,u)}return x},handleEvent:function(w){if(this.eventEnable){w.preventDefault();var y=this.getTouchPosition(w);if(w.touches){y.touchCount=w.touches.length}else{y.touchCount=1}y.event=w;var v=w.type;if(v=="keydown"||v=="keyup"){var x=new Object();for(var u in l){x[u]=l[u]}g(x,l,w)}switch(v){case"touchstart":if(this.multiTouchStart&&w.touches.length>1){this.multiTouchStart(this.getMultiTouchPosition(w))}else{if(this.touchStart){this.touchStart(y)}}break;case"mousedown":if(this.touchStart){this.touchStart(y)}break;case"touchmove":if(this.multiTouchMove&&w.touches.length>1){this.multiTouchMove(this.getMultiTouchPosition(w))}else{if(this.touchMove){this.touchMove(y)}}break;case"mousemove":if(this.touchMove){this.touchMove(y)}break;case"touchend":if(this.multiTouchEnd&&w.touches.length>1){this.multiTouchEnd(this.getMultiTouchPosition(w))}else{if(this.touchEnd){this.touchEnd(y)}}break;case"mouseup":if(this.touchEnd){this.touchEnd()}break;case"keydown":if(this.keyDown){this.keyDown(l)}break;case"keyup":if(this.keyUp){this.keyUp(x)}break}}},useEvent:function(){var v=this.field;var u=this.eventListener;if(this.touchStart&&u.touchStart==false){if(m){v.addEventListener("touchstart",this,false)}else{v.addEventListener("mousedown",this,false)}u.touchStart=true}if(this.touchMove&&u.touchMove==false){if(m){v.addEventListener("touchmove",this,false)}else{v.addEventListener("mousemove",this,false)}u.touchMove=true}if(this.touchEnd&&u.touchEnd==false){if(m){v.addEventListener("touchend",this,false)}else{v.addEventListener("mouseup",this,false)}u.touchEnd=true}if(this.multiTouchStart&&u.multiTouchStart==false){if(!u.touchStart){if(m){v.addEventListener("touchstart",this,false)}else{v.addEventListener("mousedown",this,false)}}u.touchStart=true}if(this.multiTouchMove&&u.multiTouchMove==false){if(!u.touchMove){if(m){v.addEventListener("touchmove",this,false)}else{v.addEventListener("mousemove",this,false)}}u.touchMove=true}if(this.multiTouchEnd&&u.multiTouchEnd==false){if(!u.touchEnd){if(m){v.addEventListener("touchend",this,false)}else{v.addEventListener("mouseup",this,false)}}u.touchEnd=true}if(this.keyUp&&u.keyUp==false){v.addEventListener("keyup",this,false);u.keyUp=true}if(this.keyDown&&u.keyDown==false){v.addEventListener("keydown",this,false);u.keyDown=true}},remove:function(){this._remove=true},getRand:function(v,u){return ~~(Math.random()*(u-v+1))+v},HSBtoRGB:function(z,F,D){var B,y,x,w,E;var u,A,C;y=Math.floor(z/60)%6;B=(z/60)-Math.floor(z/60);x=Math.round(D*(1-(F/255)));w=Math.round(D*(1-(F/255)*B));E=Math.round(D*(1-(F/255)*(1-B)));switch(y){case 0:u=D;A=E;C=x;break;case 1:u=w;A=D;C=x;break;case 2:u=x;A=D;C=E;break;case 3:u=x;A=w;C=D;break;case 4:u=E;A=x;C=D;break;case 5:u=D;A=x;C=w;break}if(u<=15){u="0"+u.toString(16)}else{u=u.toString(16)}if(A<=15){A="0"+A.toString(16)}else{A=A.toString(16)}if(C<=15){C="0"+C.toString(16)}else{C=C.toString(16)}return"#"+u+A+C},getSound:function(u){for(var v=0,w=j.length;v<w;v++){if(u==j[v].name){this.sound=new Audio(j[v].src)}}},soundClonePlay:function(){var u=this.sound;if(u){(new Audio(u.src)).play()}},soundLoopPlay:function(){var u=this.sound;if(u){if(!u.loop){u.addEventListener("ended",function(){this.currentTime=0;this.play()},false)}u.loop=true;u.play()}},soundReplay:function(){var u=this.sound;if(u){u.load();u.play()}},soundStop:function(){var u=this.sound;if(!u.paused){u.pause();u.currentTime=0}else{u.load()}},soundPlay:function(){var u=this.sound;if(u){u.play()}},soundPause:function(){var u=this.sound;if(u){u.pause()}},soundGetCount:function(){var u=this.sound;if(u){return u.currentTime}},soundSetCount:function(v){var u=this.sound;if(u){u.currentTime=v}},soundGetVolume:function(){var u=this.sound;if(u){return u.volume}},soundSetVolume:function(u){var v=this.sound;if(v){v.volume=u}},soundGetAlltime:function(){var u=this.sound;if(u){return u.duration}},soundIsPlaying:function(){var u=this.sound;if(u){return !u.paused}}});var b=p.createClass(Array,{initialize:function(){this.inherit();this._basicConstructor="Scene";this._remove=false},addChild:function(w){w.parent=this;if(w._basicConstructor=="Group"||w._basicConstructor=="Layer"){var v=w.children;for(var u=0,y=v.length;u<y;u++){var x=v[u];x.ctx=this.ctx;x.field=this.field}if(w._basicConstructor=="Layer"){if(!w.width){w.width=parseInt(this.field.style.width)}if(!w.height){w.height=parseInt(this.field.style.height)}}}if(this.ctx&&this.field){w.ctx=this.ctx;w.field=this.field}this.push(w)},addChildren:function(){for(var u=0,v=arguments.length;u<v;u++){this.addChild(arguments[u])}},getChild:function(v){var w=this.getChildren(v);var u=w[0];if(!u){u=null}return u},getChildren:function(y){var v=[];for(var x=0,z=this.length;x<z;x++){var u=true;for(var w in y){if(y[w]!=this[x][w]){u=false}}if(u==true){v.push(this[x])}}return v},remove:function(){this._remove=true},setImage:function(u){this.image=u},setColor:function(u){this.color=u},_enterFrame:function(x){if(this.enterFrame){this.enterFrame()}for(var u=0,y=this.length;u<y;u++){var w=this[u];if(w._basicConstructor=="Sprite"&&!w.spriteWidth){var v=w.getImageSize();if(v.width){w.setSpriteSize(v.width,v.height);if(!w.width){w.setSize(v.width,v.height);if(w._scaleX){w.scale(w._scaleX,w._scaleY)}}}}if(w.useEvent){w.useEvent()}if(w._enterFrame){w._enterFrame()}if(w.enterFrame){w.enterFrame()}if(w.tween){w.tween()}if(w.visible){if(w.preDraw){w.preDraw()}w.draw()}if(w._remove){this.splice(u,1);w=null;u--;y--}}}});var q=p.createClass(e,{initialize:function(u){this.inherit();this._basicConstructor="App";var v=document.createElement("style");v.media="screen";v.type="text/css";document.getElementsByTagName("head")[0].appendChild(v);var y;if(u){y=document.getElementById(u)}else{y=document.createElement("canvas");var x=document.getElementsByTagName("body").item(0);x.appendChild(y)}y.width=320;y.height=480;y.style.top=0+"px";y.style.left=0+"px";y.tabIndex="1";document.body.style.margin="0em";var w=navigator.userAgent;if(m){y.style.width=window.innerWidth+"px";y.style.height=window.innerHeight+"px";y.addEventListener("touchstart",function(){this.focus()})}else{y.style.width=480+"px";y.style.height=620+"px";y.addEventListener("mousedown",function(){this.focus()});y.addEventListener("keyup",function(){t(l)},false)}this._css=v;this.field=y;this.ctx=y.getContext("2d");this.fps=30;this.scene=new b();this.scene.ctx=this.ctx;this.scene.field=this.field;this.scene.parent=this},getCanvasURL:function(){return this.field.toDataURL()},getCanvasImage:function(){var u=this.field.toDataURL();window.open(u,"_blank")},colorToAlpha:function(x,w){var u;for(var v=0,y=h.length;v<y;v++){if(h[v].name==x){u=h[v];u.hex=w;u.index=v}}u.addEventListener("load",function(){var A=document.createElement("canvas");var L=A.getContext("2d");var z=this.width;var J=this.height;var I=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;var C=this.hex.replace(I,function(O,Q,P,N){return Q+Q+P+P+N+N});var M=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(C);var E=M?{r:parseInt(M[1],16),g:parseInt(M[2],16),b:parseInt(M[3],16)}:null;L.drawImage(this,0,0);var B=L.getImageData(0,0,z,J);var H=B.data;for(var G=0;G<J;G++){for(var F=0;F<z;F++){var K=G*(z*4)+(F*4);if(H[K]==E.r&&H[K+1]==E.g&&H[K+2]==E.b){H[K+3]=0}}}L.putImageData(B,0,0);var D=new Image();D.src=A.toDataURL();h[this.index]=D})},addChild:function(u){u.ctx=this.ctx;u.field=this.field;this.scene.addChild(u)},addChildren:function(){for(var u=0,v=arguments.length;u<v;u++){this.addChild(arguments[u])}},centerize:function(){var u=this.field.style;u.marginTop=-parseInt(u.height)/2+"px";u.marginLeft=-parseInt(u.width)/2+"px";u.top="50%";u.left="50%";u.position="absolute"},fitWindow:function(){this.setSize(window.innerWidth,window.innerHeight);var u=this;window.onresize=function(){u.setSize(window.innerWidth,window.innerHeight)}},setQuality:function(v,u){var w=this.field;w.width=v;w.height=u},setSize:function(w,u){var v=this.field.style;v.width=w+"px";v.height=u+"px"},getSize:function(){var u=new Object();u.width=parseInt(this.field.style.width);u.height=parseInt(this.field.style.height);return u},getQuality:function(){var u=new Object();u.width=parseInt(this.field.width);u.height=parseInt(this.field.height);return u},loadingScene:function(u){this.preScene=u;this.preScene.parent=this},_preLoadEnterFrame:function(){var y=this.field;this.useEvent();var u=this.ctx;u.clearRect(0,0,y.width,y.height);if(s>0&&this.preScene){this.preScene._enterFrame()}else{if(this.onLoad){this.onLoad()}var w=this.scene;for(var v=0,A=w.length;v<A;v++){var z=w[v];if(z._onLoad){z._onLoad()}if(z.onLoad){z.onLoad()}}clearInterval(this.preLoadInterval);var x=this;setInterval(function(){x._enterFrame()},1000/this.fps)}},_enterFrame:function(){var u=this.field;this.ctx.clearRect(0,0,u.width,u.height);this.useEvent();if(this.enterFrame){this.enterFrame()}this.scene._enterFrame()},pushScene:function(z){var C=this.ctx;var B=this.field;var v=this.scene;for(var y=0,w=v.length;y<w;y++){var A=v[y];A.eventEnable=false;if(A.onSceneremoved){A.onSceneRemoved()}}for(var y=0,w=z.length;y<w;y++){var x=z[y];x.ctx=C;x.field=B;x.eventEnable=true;if(x.onScenePushed){x.onScenePushed()}}z.parent=this;z.ctx=C;z.field=B;var u=this.field.style;u.background=null;u.backgroundColor="white";if(z.color){this.setColor(z.color)}if(z.image){this.setImage(z.image)}this.scene=z},setColor:function(u){var v=this.field.style;v.background=null;v.backgroundColor=u},setImage:function(u){var v=this.field.style;v.background="url("+u+") no-repeat center";v.backgroundSize="cover"},start:function(){var v=this.field;var u=this;this.ctx.clearRect(0,0,v.width,v.height);this.preLoadInterval=setInterval(function(){u._preLoadEnterFrame()},1000/this.fps)},toDataURL:function(){return this.field.toDataURL()},load:function(){function w(G){var E;if(!G){return E}var F=G.split(".");var D=F.length;if(D===0){return E}E=F[D-1];return E}for(var A=0,x=arguments.length;A<x;A++){var y=arguments[A];if(y instanceof Array){var z=y[0];var u=y[1]}else{var z=y;var u=y}var v=w(z);if(v=="wav"||v=="mp3"||v=="ogg"){var y=new Audio(z);y.name=u;s++;y.addEventListener("canplaythrough",function(){s--;console.log(this.src+" is loaded")});j.push(y)}else{if(v=="TTF"||v=="ttf"){var B=this._css;var C=document.createTextNode("@font-face{font-family:'"+u+"';src: url('"+z+"') format('truetype');}");if(B.styleSheet){B.styleSheet.cssText=C}else{B.appendChild(C)}}else{if(v=="svg"){var y=document.createElement("object");y.addEventListener("load",function(){s--;this.style.display="none";console.log(this.data+" is loaded")});y.data=z;y.name=u;document.body.appendChild(y);s++;a.push(y)}else{if(v=="png"||v=="gif"||v=="jpeg"||v=="jpg"){var y=new Image();y.addEventListener("load",function(){s--;console.log(this.src+" is loaded")});y.src=z;y.name=u;s++;h.push(y)}}}}}}});var o=p.createClass(e,{initialize:function(v,u){this.inherit();this.x=0;this.y=0;this._remove=false;this.width=v;this.height=u;this.collisionShape="box";this.alpha=1;this.field},_scaleBy:function(u){if(u.time==0){u.toWidth=this.width*u.scaleX;u.toHeight=this.height*u.scaleY;u.diffWidth=u.toWidth-this.width;u.diffHeight=u.toHeight-this.height}this.width=u.toWidth-u.diffWidth*(1-u.time/u.frame);this.height=u.toHeight-u.diffHeight*(1-u.time/u.frame)},intersect:function(D,B){var z=this.x;var w=this.y;if(this.parent._basicConstructor=="Group"){z+=this.parent.x;w+=this.parent.y}if(this.collisionShape=="box"){var G=D-(z+this.width/2);var F=B-(w+this.height/2);var v=this.rot;var H=Math.sin(-v);var E=Math.cos(-v);var u=Math.abs(G*E-F*H);var C=Math.abs(G*H+F*E);if(u<this.width/2&&C<this.height/2){return true}return false}else{if(this.collisionShape=="circle"){var A=this.width/2;var G=D-(z+A);var F=B-(w+A);if(Math.sqrt(G*G+F*F)<A){return true}return false}else{return false}}},hitTest:function(D){if(this.collisionShape=="box"){if(D.collisionShape=="circle"){return D.within(this,D.width/2)}}else{if(this.collisionShape=="circle"){return this.within(D,this.width/2)}else{return false}}var A=this.x;var y=this.y;var G=this.width;var C=this.height;var H=A+this.width/2;var F=y+this.height/2;var x=D.x;var v=D.y;var E=D.width;var B=D.height;if(this.parent._basicConstructor=="Group"){A+=this.parent.x;y+=this.parent.y}if(D.rot!=0&&D.rot!=Math.PI){if(D.collisionShape=="box"){var z=x+E/2;var w=v+B/2;var H=A+G/2;var F=y+C/2;var u=-D.rot;H=Math.cos(u)*(H-z)-Math.sin(u)*(F-w)+z;F=Math.sin(u)*(H-z)+Math.cos(u)*(F-w)+w;A=H-G/2;y=F-C/2}}return(A<x+E)&&(x<A+G)&&(y<v+B)&&(v<y+C)},within:function(G,D){var C=this.x;var A=this.y;if(this.parent._basicConstructor=="Group"){C+=this.parent.x;A+=this.parent.y}if(this.collisionShape=="box"){var M=C+this.width/2;var L=A+this.height/2}else{if(this.collisionShape=="circle"){var F=this.width/2;var M=C+F;var L=A+F}else{return false}}if(G.collisionShape=="box"){var B=G.x+G.width/2;var z=G.y+G.height/2;var u=-G.rot;var w=Math.cos(u)*(M-B)-Math.sin(u)*(L-z)+B;var v=Math.sin(u)*(M-B)+Math.cos(u)*(L-z)+z;var K,I;if(w<G.x){K=G.x}else{if(w>G.x+G.width){K=G.x+G.width}else{K=w}}if(v<G.y){I=G.y}else{if(v>G.y+G.height){I=G.y+G.height}else{I=v}}var J=Math.abs(w-K);var H=Math.abs(v-I)}else{if(G.collisionShape=="circle"){var E=G.width/2;var K=G.x+E;var I=G.y+E;var J=Math.abs(M-K);var H=Math.abs(L-I);D+=E}else{return false}}if(Math.sqrt((J*J)+(H*H))<D){return true}return false},scale:function(v,u){if(!this.width){this._scaleX=v;this._scaleY=u}else{this.width*=v;this.height*=u}return this},setSize:function(u,v){this.width=u;this.height=v}});var f=p.createClass(o,{initialize:function(w,u,v){this.inherit(0,0);this.obj=-1;if(typeof w=="object"){this.path=w}else{if(typeof w=="string"){this.setImage(w)}}this.closeMode=true;if(u){this.color=u}else{this.color="original"}if(v){this.strokeColor=v}else{this.strokeColor="original"}},setImage:function(v){for(var u=0,w=a.length;u<w;u++){if(v==a[u].name){this.obj=u}}},parsePath:function(x){var v={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var u=/([astvzqmhlc])([^astvzqmhlc]*)/ig;var w=[];x.replace(u,function(z,C,y){var A=C.toLowerCase();y=y.match(/-?[.0-9]+(?:e[-+]?\d+)?/ig);y=y?y.map(Number):[];if(A=="m"&&y.length>2){w.push([C].concat(y.splice(0,2)));A="l";C=C=="m"?"l":"L"}while(true){if(y.length==v[A]){y.unshift(C);if(y[0]=="q"){var B={method:"quadraticCurveBy",cpx:y[1],cpy:y[2],x:y[3],y:y[4]}}else{if(y[0]=="Q"){var B={method:"quadraticCurveTo",cpx:y[1],cpy:y[2],x:y[3],y:y[4]}}else{if(y[0]=="l"){var B={method:"lineBy",x:y[1],y:y[2]}}else{if(y[0]=="L"){var B={method:"lineTo",x:y[1],y:y[2]}}else{if(y[0]=="m"){var B={method:"moveBy",x:y[1],y:y[2]}}else{if(y[0]=="M"){var B={method:"moveTo",x:y[1],y:y[2]}}else{if(y[0]=="c"){var B={method:"bezierCurveBy",cpx1:y[1],cpy1:y[2],cpx2:y[3],cpy2:y[4],x:y[5],y:y[6]}}else{if(y[0]=="C"){var B={method:"bezierCurveTo",cpx1:y[1],cpy1:y[2],cpx2:y[3],cpy2:y[4],x:y[5],y:y[6]}}else{if(y[0]=="h"){var B={method:"horizontalBy",x:y[1]}}else{if(y[0]=="H"){var B={method:"horizontalTo",x:y[1]}}else{if(y[0]=="v"){var B={method:"verticalBy",y:y[1]}}else{if(y[0]=="V"){var B={method:"verticalTo",y:y[1]}}else{if(y[0]=="s"){var B={method:"bezierCurveShortBy",cpx2:y[1],cpy2:y[2],x:y[3],y:y[4]}}else{if(y[0]=="S"){var B={method:"bezierCurveShortTo",cpx2:y[1],cpy2:y[2],x:y[3],y:y[4]}}else{if(y[0]=="t"){var B={method:"quadraticCurveShortBy",x:y[1],y:y[2]}}else{if(y[0]=="T"){var B={method:"quadraticCurveShortTo",x:y[1],y:y[2]}}else{var B={}}}}}}}}}}}}}}}}}return w.push(B)}w.push([C].concat(y.splice(0,v[A])))}});return w},_onLoad:function(){var x=a[this.obj].getSVGDocument();var v=x.getElementsByTagName("path")[0];var u=x.getElementsByTagName("svg")[0];var w=v.getAttribute("d");if(this.color=="original"){this.color=v.getAttribute("fill")}if(this.strokeColor=="original"){this.strokeColor==v.getAttribute("stroke")}this.path=this.parsePath(w);this.spriteWidth=parseInt(u.getAttribute("width"));this.spriteHeight=parseInt(u.getAttribute("height"));console.log(this.width);if(!this.width){this.width=this.spriteWidth}if(!this.height){this.height=this.spriteHeight}},draw:function(){var I=this.path;var L=this.ctx;var F=0;var E=0;var z=0;var u=0;var C=0;var B=0;var K=this.width;var G=this.height;var Q=K/this.spriteWidth;var P=G/this.spriteHeight;var O=K/2;var N=G/2;var A=this._x||this.x;var w=this._y||this.y;var D=this._rot||this.rot;L.globalAlpha=this.alpha;L.globalCompositeOperation=this.drawMode;L.save();L.translate(A+O,w+N);L.rotate(D);L.translate(-O,-N);L.scale(Q,P);L.beginPath();for(var M=0,J=I.length;M<J;M++){var H=this.path[M];var v=H.method;if(v=="moveTo"||v=="quadraticCurveTo"||v=="bezierCurveTo"||v=="lineTo"||v=="bezierCurveShortTo"||v=="quadraticCurveShortTo"){z=0;u=0;F=H.x;E=H.y}else{z=F;u=E;F+=H.x;E+=H.y}if(v=="moveTo"||v=="moveBy"){L.moveTo(F,E)}else{if(v=="lineTo"||v=="lineBy"){L.lineTo(F,E)}else{if(v=="quadraticCurveBy"||v=="quadraticCurveTo"){L.quadraticCurveTo(z+H.cpx,u+H.cpy,F,E);C=2*F-(z+H.cpx);B=2*E-(u+H.cpy)}else{if(v=="bezierCurveTo"||v=="bezierCurveBy"){L.bezierCurveTo(z+H.cpx1,u+H.cpy1,z+H.cpx2,u+H.cpy2,F,E);C=2*F-(z+H.cpx2);B=2*E-(u+H.cpy2)}else{if(v=="horizontalTo"||v=="horizontalBy"){L.lineTo(H.x,E)}else{if(v=="verticalTo"||v=="verticalBy"){L.lineTo(F,H.y)}else{if(v=="bezierCurveShortBy"||v=="bezierCurveShortTo"){L.bezierCurveTo(C,B,z+H.cpx2,u+H.cpy2,F,E);C=2*F-(z+H.cpx2);B=2*E-(u+H.cpy2)}else{if(v=="quadraticCurveShortBy"||v=="quadraticCurveShortTo"){L.quadraticCurveTo(C,B,F,E);C=2*F-C;B=2*E-B}}}}}}}}}if(this.closeMode){L.closePath()}L.fillStyle=this.color;L.fill();L.strokeStyle=this.strokeColor;L.stroke();L.restore()},getNodeByName:function(u){var x=this.path;for(var v=0,y=x.length;v<y;v++){var w=x[v];if(u==w.name){return w}}return -1}});f.Box=p.createClass(o,{initialize:function(v,w,u){this.inherit(w,u);this._basicConstructor="Shape";this.color=v},draw:function(){var z=this.ctx;z.globalAlpha=this.alpha;z.globalCompositeOperation=this.drawMode;z.beginPath();z.fillStyle=this.color;var v=this._x||this.x;var D=this._y||this.y;var w=this._rot||this.rot;var B=this._width||this.width;var u=this._height||this.height;var C=v+this.width/2;var A=D+this.height/2;z.save();z.translate(C,A);z.rotate(w);z.translate(-C,-A);var v=this._x||this.x;var D=this._y||this.y;z.fillRect(v,D,this.width,this.height);z.restore();z.globalAlpha=1}});f.Circle=p.createClass(o,{initialize:function(v,u){this.inherit(u*2,u*2);this._basicConstructor="Shape";this.color=v;this.collisionShape="circle"},draw:function(){var v=this.ctx;v.globalAlpha=this.alpha;v.globalCompositeOperation=this.drawMode;v.beginPath();v.fillStyle=this.color;var w=this._width||this.width;var A=w/2;var u=this._x||this.x;var z=this._y||this.y;v.arc(u+A,z+A,A,0,Math.PI*2,false);v.fill();v.globalAlpha=1}});var k=p.createClass(o,{initialize:function(v,w,u){if(typeof w==="undefined"){w=null;u=null}this.inherit(w,u);this.setImage(v,w,u);this._basicConstructor="Sprite";this.frame=0;this.alpha=1},animate:function(x,u,w){var v=i(this,"animate",w);v.array=x;v.frameRate=u;v.frameIdx=0;return this},_animate:function(u){if(u.time==0){this.frame=u.array[0]}if(u.time%u.frameRate==0){u.frameIdx=(u.frameIdx+1)%u.array.length;this.frame=u.array[u.frameIdx]}},setSpriteSize:function(v,u){this.spriteWidth=v;this.spriteHeight=u},setImage:function(v,x,u){if(x&&u){this.setSpriteSize(x,u)}var y=h.length;for(var w=0;w<y;w++){if(h[w].name==v){this.img=w}}},getImage:function(){return h[this.img]},getImageSize:function(){var v={};var u=h[this.img];v.width=u.width;v.height=u.height;return v},draw:function(){var H=this.ctx;H.globalAlpha=this.alpha;H.globalCompositeOperation=this.drawMode;var D=this.frame;var F=h[this.img];var L=this.spriteWidth;var J=this.spriteHeight;var G=this._width||this.width;var E=this._height||this.height;var K=G/2;var I=E/2;var v=F.width/L;var u=F.height/J;var N=G/L;var M=E/J;var C=(D%v)*L;var B=(~~(D/v)%u)*J;var A=this._x||this.x;var z=this._y||this.y;var w=this._rot||this.rot;H.save();H.translate(A+K,z+I);H.rotate(w);H.translate(-K,-I);H.scale(N,M);if(C!=null){H.drawImage(F,C,B,L,J,0,0,L,J)}H.restore();H.globalAlpha=1}});var d=p.createClass(k,{initialize:function(v,w,u){this.inherit(v,w,u);this.drawData;this.hitData},intersect:function(C,B){var A=this.hitData;var E=A[0].length;var D=A.length;var w=this.width;var F=this.height;var v=this.x;var u=this.y;for(var z=0;z<D;z++){for(var G=0;G<E;G++){if(A[z][G]==1&&v+G*w<C&&C<v+(G+1)*w&&u+z*F<B&&B<u+(z+1)*F){return true}}}return false},draw:function(){var D=this.drawData;var F=D[0].length;var E=D.length;var O=this.width;var M=this.height;var L=this.x;var K=this.y;var Q=0;var I=0;var u=this.field;var P=this.ctx;P.globalAlpha=this.alpha;P.globalCompositeOperation=this.drawMode;var z=u.height;var B=u.width;var J;var N=h[this.img];var U=this.spriteWidth;var T=this.spriteHeight;var S=this.width/2;var R=this.height/2;var C=N.width/U;var A=N.height/T;var W=this.width/U;var V=this.height/T;var H=(J%C)*U;var G=(~~(J/C)%A)*T;var w=this._x||this.x;var v=this._y||this.y;while(Q<E){while(I<F){J=D[Q][I];if(J>=0&&z>K+M*Q&&K+M*(Q+1)>0&&B>L+O*I&&L+O*(I+1)>0){var H=(J%C)*U;var G=(~~(J/C)%A)*T;P.save();P.translate(w,v);P.scale(W,V);P.drawImage(N,H,G,U,T,0,0,U,T);P.restore()}this.x+=O;I++}this.y+=M;Q++;this.x=L;I=0}this.x=L;this.y=K}});var r=p.createClass(e,{initialize:function(w,v,x,u){this.inherit();this._basicConstructor="Text";this.x=0;this.y=0;this.scaleX=1;this.scaleY=1;this.alpha=1;this.spaceWidth=7;if(u){this.font="'"+u+"'"}else{this.font="'Meiryo'"}if(x){this.size=x+"px"}else{this.size="10px"}if(w){this.string=w}else{this.string=""}if(v){this.color=v}else{this.color="white"}},setSize:function(u){this.size=u+"px"},setFont:function(u){this.font="'"+u+"'"},intersect:function(D,B){var A=this.x;var z=this.y;var w=parseInt(this.size)*this.scaleX*this.string.length;var H=parseInt(this.size)*this.scaleY;var G=D-(A+w/2);var F=B-(z+H/2);var v=this.rot;var I=Math.sin(-v);var E=Math.cos(-v);var u=Math.abs(G*E-F*I);var C=Math.abs(G*I+F*E);if(u<w/2&&C<H/2){return true}return false},scale:function(u,v){this.scaleX*=u;this.scaleY*=v},_scaleBy:function(u){if(u.time==0){u.diffWidth=u.scaleX-this.scaleX;u.diffHeight=u.scaleY-this.scaleY}this.scaleX=u.scaleX-u.diffWidth*(1-u.time/u.frame);this.scaleY=u.scaleY-u.diffHeight*(1-u.time/u.frame)},draw:function(){var C=this._x||this.x;var B=this._y||this.y;var u=this._rot||this.rot;var E=this.scaleX;var D=this.scaleY;var H=this.ctx;var F=this.string.split("<br>");var v=F.length;H.globalAlpha=this.alpha;H.globalCompositeOperation=this.drawMode;H.font=this.size+" "+this.font;var G=H.measureText("a").width*1.5+this.spaceWidth;H.fillStyle=this.color;H.save();var A=parseInt(this.size)*this.scaleX*this.string.length/2;var z=parseInt(this.size)*this.scaleY/2;H.translate(C+A,B+z);H.rotate(u);H.translate(-A,-z);H.scale(E,D);for(var w=0;w<v;w++){H.fillText(F[w],0,G);G*=2}H.restore();H.globalAlpha=1}});var n=p.createClass(o,{initialize:function(){this.inherit();this.x=0;this.y=0;this.children=[];this._basicConstructor="Group";for(var u=0,v=arguments.length;u<v;u++){this.children.push(arguments[u])}},draw:function(){var v=this.children;for(var u=0,x=v.length;u<x;u++){var w=v[u];w.x+=this.x;w.y+=this.y;if(w.useEvent){w.useEvent()}if(w.enterFrame){w.enterFrame()}if(w.tween){w.tween()}if(w.visible){w.draw()}if(w._remove){this.splice(u,1);w=null;u--;x--}w.x-=this.x;w.y-=this.y}},scale:function(u,B){var w=this.children;for(var v=0,A=arguments.length;v<A;v++){var z=w[v];if(z.scale){z.scale(u,B)}}},addChild:function(u){u.parent=this;this.children.push(u)},addChildren:function(){for(var u=0,v=arguments.length;u<v;u++){this.addChild(arguments[u])}}});window.Atlas=p;p.Util=e;p.Thing=o;p.App=q;p.Sprite=k;p.Shape=f;p.Map=d;p.Text=r;p.Scene=b;p.Group=n})();